# 组合模式

# 定义

将对象以树形结构组织起来，以达成“部分－整体”的层次结构，

使得客户端对单个对象和组合对象的使用具有一致性。

# 动机

客户代码过多地依赖于对象容器复杂的内部实现结构，对象容器内部实现结构（而非抽象接口）的变化将引起客户代码的频繁变化，带来了代码的维护性、扩展性等弊端。

如何将“客户代码与复杂的对象容器结构”解耦？

让对象容器自己来实现自身的复杂结构

从而使得客户代码就像处理简单对象一样来处理复杂的对象容器？

# 意图

将对象组合成树形结构以表示“部分-整体”的层次结构。

Composite使得用户对单个对象和组合对象的使用具有一致性。

组合模式，现在学习就是虚类继承虚类，然后增加虚方法。

最终实类继承第二个虚类，重写所有虚方法。

# 结构

1. Component
   
    组合中的对象声明接口，在适当情况下实现所有类共有的默认行为，
    
     声明一个接口用于访问和管理Component的子组件。
    
    在递归结构中定义一个接口，用于访问一个父部件，并在合适的情况下实现它。（可选）
    
2. Leaf
   
    在组合中表示叶节点，叶节点没有子节点，定义对象的基本行为。
    
3. Composite
   
    定义有子部件的那些部件的行为，存储子部件并在Component接口实现与子部件有关的操作。
    
4. Client
   
    通过Component接口操作组合部件的对象。
    

# 使用场景

1. 需求重要体现部分与整体的层次结构时
2. 你希望用户忽略组合对象与单个对象的不同，用户将统一地使用组合结构中的所有对象。

# 优缺点

## 优点

1. 使客户端调用简单，客户端可以一致的使用组合结构或其中单个对象，用户就不必关系自己处理的是单个对象还是整个组合结构，这就简化了客户端代码。
2. 更容易在组合体内加入对象部件. 客户端不必因为加入了新的对象部件而更改代码。

## 缺点

1. 组合模式不容易限制组合中的构件

# 实现

有两种实现方式
1. **透明式**的组合模式
2. **安全式**的组合模式